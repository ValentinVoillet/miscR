% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/call_positivity.R
\name{call_positivity}
\alias{call_positivity}
\title{Fisher's Exact Test for Positivity Calls}
\usage{
call_positivity(
  x,
  alpha = 1e-05,
  group_cols = c("PROTOCOL", "LABID", "ASSAYID", "PTID", "VISITNO", "SUBSET"),
  adjustment = "holm"
)
}
\arguments{
\item{x}{A data.frame or tibble. Must contain columns generated by
\code{calculate_bg_adjustment} (CYTNUM, NSUB, CYTNUM_NEG, NSUB_NEG).}

\item{alpha}{Numeric. The significance threshold for the adjusted p-value.
Default is \code{0.00001}.}

\item{group_cols}{Vecteur of characters. Columns used to group data for the
p-value adjustment (multiplicity correction).}

\item{adjustment}{Character. The correction method passed to \code{stats::p.adjust}.
Default is \code{"holm"}. Options include "bonferroni", "BH", "fdr", etc.}
}
\value{
A data.frame with additional columns:
\item{raw_p}{Original p-value from Fisher's Exact Test}
\item{num_tests}{Number of tests performed within each group}
\item{adjvar}{A string listing the variables used for adjustment grouping}
\item{adjp}{P-value adjusted using the specified \code{adjustment} method}
\item{response}{Binary indicator (1 for positive, 0 for negative)}
}
\description{
Performs a row-wise Fisher's Exact Test comparing stimulated samples to
their negative controls, followed by a Holm-Bonferroni p-value adjustment.
}
